{% extends 'textbook/base.html' %}
{% load static %}


{% block title %}–ì–ª–∞–≤–Ω–∞—è - CodeMaster{% endblock %}

{% block content %}
<div class="fade-in">
    <!-- –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ —Å —É—á–µ—Ç–æ–º –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ -->
    <div class="card" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white;">
        <h1 style="font-size: 2.5rem; margin-bottom: 1rem;">
            {% if user.is_authenticated %}
            –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å, {{ user.username }}! üë®‚Äçüíª
            {% else %}
            –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –æ–Ω–ª–∞–π–Ω —É—á–µ–±–Ω–∏–∫! üë®‚Äçüíª
            {% endif %}
        </h1>
        <p style="font-size: 1.2rem; opacity: 0.9;">
            {% if user.is_authenticated %}
            –ü—Ä–æ–¥–æ–ª–∂–∞–π—Ç–µ –∏–∑—É—á–∞—Ç—å –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –Ω–∞—à–∏–º–∏ –º–∞—Ç–µ—Ä–∏–∞–ª–∞–º–∏. –í–∞—à –ø—Ä–æ–≥—Ä–µ—Å—Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω!
            {% else %}
            –ò–∑—É—á–∞–π—Ç–µ –ø—Ä–æ–≥—Ä–∞–º–º–∏—Ä–æ–≤–∞–Ω–∏–µ —Å –ø–æ–º–æ—â—å—é –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã—Ö –ª–µ–∫—Ü–∏–π, –ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏—Ö –∑–∞–¥–∞–Ω–∏–π –∏ —Ç–µ—Å—Ç–æ–≤.
            <br>
            <a href="{% url 'register' %}" style="color: white; text-decoration: underline; font-weight: bold;">
                –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä—É–π—Ç–µ—Å—å
            </a> –∏–ª–∏ 
            <a href="{% url 'login' %}" style="color: white; text-decoration: underline; font-weight: bold;">
                –≤–æ–π–¥–∏—Ç–µ
            </a> –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫–æ –≤—Å–µ–º –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—è–º!
            {% endif %}
        </p>
        
        {% if user.is_authenticated %}
        <div style="display: flex; gap: 1rem; margin-top: 1.5rem; flex-wrap: wrap;">
            <div style="display: flex; align-items: center; gap: 10px; padding: 10px 15px; background: rgba(255,255,255,0.2); border-radius: 10px;">
                <i class="fas fa-user-check"></i>
                <span>–í—ã –≤–æ—à–ª–∏ –∫–∞–∫: <strong>{{ user.username }}</strong></span>
            </div>
            <div style="display: flex; align-items: center; gap: 10px; padding: 10px 15px; background: rgba(255,255,255,0.2); border-radius: 10px;">
                <i class="fas fa-calendar"></i>
                <span>–î–∞—Ç–∞ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏: {{ user.date_joined|date:"d.m.Y" }}</span>
            </div>
        </div>
        {% endif %}
    </div>

    <!-- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ (—Ç–æ–ª—å–∫–æ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö) -->
    {% if user.is_authenticated %}
    <div class="card">
        <h2><i class="fas fa-chart-line"></i> –í–∞—à –ø—Ä–æ–≥—Ä–µ—Å—Å</h2>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; margin-top: 1.5rem;">
            <div style="text-align: center; padding: 1.5rem; background: #f0f9ff; border-radius: 10px;">
                <div style="font-size: 2rem; font-weight: bold; color: var(--primary);">0</div>
                <div style="color: var(--gray);">–ü—Ä–æ–π–¥–µ–Ω–æ —Ç–µ—Å—Ç–æ–≤</div>
            </div>
            <div style="text-align: center; padding: 1.5rem; background: #f0f9ff; border-radius: 10px;">
                <div style="font-size: 2rem; font-weight: bold; color: var(--success);">0</div>
                <div style="color: var(--gray);">–õ–µ–∫—Ü–∏–π –∏–∑—É—á–µ–Ω–æ</div>
            </div>
            <div style="text-align: center; padding: 1.5rem; background: #f0f9ff; border-radius: 10px;">
                <div style="font-size: 2rem; font-weight: bold; color: var(--accent);">35%</div>
                <div class="progress-container">
                    <div class="progress-label">
                        <span>–û–±—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å</span>
                        <span>35%</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="course-progress"></div>
                    </div>
                </div>
            </div>
            <div style="text-align: center; padding: 1.5rem; background: #f0f9ff; border-radius: 10px;">
                <div style="font-size: 2rem; font-weight: bold; color: var(--warning);">0</div>
                <div style="color: var(--gray);">–î–æ—Å—Ç–∏–∂–µ–Ω–∏–π</div>
            </div>
        </div>
    </div>
    {% endif %}

    <!-- –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ —Ç–µ—Å—Ç—ã -->
    <div class="card">
        <h2><i class="fas fa-clipboard-check"></i> –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º—ã–µ —Ç–µ—Å—Ç—ã</h2>
        <div style="margin-top: 1.5rem;">
            <div style="display: flex; justify-content: space-between; align-items: center; padding: 1.5rem; background: #f0f9ff; border-radius: 10px; margin-bottom: 1rem;">
                <div>
                    <h3 style="color: var(--primary);">–¢–µ—Å—Ç: –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ 1</h3>
                    <p style="color: var(--gray); margin: 5px 0;">4 –≤–æ–ø—Ä–æ—Å–∞ ¬∑ –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∑–∞–¥–∞—á–∏ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏</p>
                </div>
                {% if user.is_authenticated %}
                <a href="{% url 'tests' %}" class="btn" onclick="startTestFromHome(1)">
                    <i class="fas fa-pencil-alt"></i> –ü—Ä–æ–π—Ç–∏ —Ç–µ—Å—Ç
                </a>
                {% else %}
                <a href="{% url 'login' %}" class="btn">
                    <i class="fas fa-lock"></i> –í–æ–π–¥–∏—Ç–µ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞
                </a>
                {% endif %}
            </div>
            
            <div style="display: flex; justify-content: space-between; align-items: center; padding: 1.5rem; background: #f0f9ff; border-radius: 10px;">
                <div>
                    <h3 style="color: var(--primary);">–¢–µ—Å—Ç: –õ–∞–±–∞—Ä–∞—Ç–æ—Ä–Ω–∞—è —Ä–∞–±–æ—Ç–∞ 2</h3>
                    <p style="color: var(--gray); margin: 5px 0;">2 –≤–æ–ø—Ä–æ—Å–∞ ¬∑ –°–æ–∑–¥–∞–Ω–∏–µ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–π</p>
                </div>
                {% if user.is_authenticated %}
                <a href="{% url 'tests' %}" class="btn" onclick="startTestFromHome(3)">
                    <i class="fas fa-code"></i> –ü—Ä–æ–π—Ç–∏ —Ç–µ—Å—Ç
                </a>
                {% else %}
                <a href="{% url 'login' %}" class="btn">
                    <i class="fas fa-lock"></i> –í–æ–π–¥–∏—Ç–µ –¥–ª—è –¥–æ—Å—Ç—É–ø–∞
                </a>
                {% endif %}
            </div>
        </div>
    </div>
    
    <!-- –ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø -->
    <div class="card">
        <h2><i class="fas fa-bolt"></i> –ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø</h2>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 1rem; margin-top: 1.5rem;">
            <a href="{% url 'lectures' %}" style="text-decoration: none;">
                <div style="text-align: center; padding: 1.5rem; background: var(--light); border-radius: 10px; transition: all 0.3s; cursor: pointer;">
                    <div style="font-size: 2rem; color: var(--primary); margin-bottom: 0.5rem;">
                        <i class="fas fa-book"></i>
                    </div>
                    <div style="font-weight: bold; color: var(--dark);">–õ–µ–∫—Ü–∏–∏</div>
                    {% if not user.is_authenticated %}
                    <div style="font-size: 0.8rem; color: var(--gray); margin-top: 5px;">
                        <i class="fas fa-lock"></i> –¢—Ä–µ–±—É–µ—Ç—Å—è –≤—Ö–æ–¥
                    </div>
                    {% endif %}
                </div>
            </a>
            
            <a href="{% url 'tests' %}" style="text-decoration: none;">
                <div style="text-align: center; padding: 1.5rem; background: var(--light); border-radius: 10px; transition: all 0.3s; cursor: pointer;">
                    <div style="font-size: 2rem; color: var(--success); margin-bottom: 0.5rem;">
                        <i class="fas fa-clipboard-check"></i>
                    </div>
                    <div style="font-weight: bold; color: var(--dark);">–¢–µ—Å—Ç—ã</div>
                    {% if not user.is_authenticated %}
                    <div style="font-size: 0.8rem; color: var(--gray); margin-top: 5px;">
                        <i class="fas fa-lock"></i> –¢—Ä–µ–±—É–µ—Ç—Å—è –≤—Ö–æ–¥
                    </div>
                    {% endif %}
                </div>
            </a>
            
            
            
            <a href="{% url 'lab' %}" style="text-decoration: none;">
                <div style="text-align: center; padding: 1.5rem; background: var(--light); border-radius: 10px; transition: all 0.3s; cursor: pointer;">
                    <div style="font-size: 2rem; color: var(--warning); margin-bottom: 0.5rem;">
                        <i class="fas fa-flask"></i>
                    </div>
                    <div style="font-weight: bold; color: var(--dark);">–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–Ω—ã–µ</div>
                    {% if not user.is_authenticated %}
                    <div style="font-size: 0.8rem; color: var(--gray); margin-top: 5px;">
                        <i class="fas fa-lock"></i> –¢—Ä–µ–±—É–µ—Ç—Å—è –≤—Ö–æ–¥
                    </div>
                    {% endif %}
                </div>
            </a>
        </div>
        
        {% if not user.is_authenticated %}
        <div style="text-align: center; margin-top: 1.5rem; padding: 1rem; background: #fef3c7; border-radius: 10px; border-left: 4px solid var(--warning);">
            <p style="margin: 0; color: #92400e;">
                <i class="fas fa-exclamation-triangle"></i>
                –î–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫–æ –≤—Å–µ–º —Ä–∞–∑–¥–µ–ª–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ 
                <a href="{% url 'register' %}" style="color: var(--primary); font-weight: bold;">–∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</a> 
                –∏–ª–∏ 
                <a href="{% url 'login' %}" style="color: var(--primary); font-weight: bold;">–≤–æ–π—Ç–∏</a> –≤ —Å–∏—Å—Ç–µ–º—É.
            </p>
        </div>
        {% endif %}
    </div>

    <!-- –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π -->
    {% if not user.is_authenticated %}
    <div class="card">
        <h2><i class="fas fa-star"></i> –ü–æ—á–µ–º—É —Å—Ç–æ–∏—Ç –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è?</h2>
        <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 1.5rem; margin-top: 1.5rem;">
            <div style="text-align: center; padding: 1.5rem; background: linear-gradient(135deg, #e0e7ff, #dbeafe); border-radius: 10px;">
                <div style="font-size: 2.5rem; color: var(--primary); margin-bottom: 1rem;">
                    <i class="fas fa-chart-line"></i>
                </div>
                <h3 style="color: var(--dark);">–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞</h3>
                <p style="color: var(--gray);">–°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–æ–≤ –∏ —Å–ª–µ–¥–∏—Ç–µ –∑–∞ —Å–≤–æ–∏–º —Ä–∞–∑–≤–∏—Ç–∏–µ–º</p>
            </div>
            
            <div style="text-align: center; padding: 1.5rem; background: linear-gradient(135deg, #f0f9ff, #e0f2fe); border-radius: 10px;">
                <div style="font-size: 2.5rem; color: var(--success); margin-bottom: 1rem;">
                    <i class="fas fa-trophy"></i>
                </div>
                <h3 style="color: var(--dark);">–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</h3>
                <p style="color: var(--gray);">–ü–æ–ª—É—á–∞–π—Ç–µ –Ω–∞–≥—Ä–∞–¥—ã –∑–∞ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ –∫—É—Ä—Å–æ–≤ –∏ —Ç–µ—Å—Ç–æ–≤</p>
            </div>
            
            <div style="text-align: center; padding: 1.5rem; background: linear-gradient(135deg, #f0fdf4, #dcfce7); border-radius: 10px;">
                <div style="font-size: 2.5rem; color: var(--accent); margin-bottom: 1rem;">
                    <i class="fas fa-bookmark"></i>
                </div>
                <h3 style="color: var(--dark);">–ò–∑–±—Ä–∞–Ω–Ω–æ–µ</h3>
                <p style="color: var(--gray);">–°–æ—Ö—Ä–∞–Ω—è–π—Ç–µ –≤–∞–∂–Ω—ã–µ –ª–µ–∫—Ü–∏–∏ –∏ –º–∞—Ç–µ—Ä–∏–∞–ª—ã –¥–ª—è –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏—è</p>
            </div>
        </div>
        
        <div style="text-align: center; margin-top: 2rem;">
            <a href="{% url 'register' %}" class="btn" style="font-size: 1.1rem; padding: 1rem 2rem;">
                <i class="fas fa-user-plus"></i> –ù–∞—á–∞—Ç—å –æ–±—É—á–µ–Ω–∏–µ –±–µ—Å–ø–ª–∞—Ç–Ω–æ
            </a>
            <p style="color: var(--gray); margin-top: 1rem;">
                –£–∂–µ –µ—Å—Ç—å –∞–∫–∫–∞—É–Ω—Ç? <a href="{% url 'login' %}" style="color: var(--primary); font-weight: bold;">–í–æ–π–¥–∏—Ç–µ –∑–¥–µ—Å—å</a>
            </p>
        </div>
    </div>
    {% endif %}
</div>

<script>
    // –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å
    document.addEventListener('DOMContentLoaded', function() {
        document.getElementById('course-progress').style.width = '35%';
    });

    // –§—É–Ω–∫—Ü–∏—è –¥–ª—è –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–∞ —Å –≥–ª–∞–≤–Ω–æ–π —Å—Ç—Ä–∞–Ω–∏—Ü—ã
    function startTestFromHome(testId) {
        // –°–æ—Ö—Ä–∞–Ω—è–µ–º ID —Ç–µ—Å—Ç–∞ –≤ localStorage
        localStorage.setItem('startTestId', testId);
        
        // –ü–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É —Ç–µ—Å—Ç–æ–≤
        window.location.href = "{% url 'tests' %}";
    }

    // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏ –∫–ª–∏–∫–µ –Ω–∞ –∑–∞—â–∏—â–µ–Ω–Ω—ã–µ —Ä–∞–∑–¥–µ–ª—ã
    document.addEventListener('DOMContentLoaded', function() {
        const protectedLinks = document.querySelectorAll('a[href*="lectures"], a[href*="tests"], a[href*="lab"]');
        
        protectedLinks.forEach(link => {
            link.addEventListener('click', function(e) {
                {% if not user.is_authenticated %}
                e.preventDefault();
                alert('–î–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —ç—Ç–æ–º—É —Ä–∞–∑–¥–µ–ª—É –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤–æ–π—Ç–∏ –≤ —Å–∏—Å—Ç–µ–º—É.');
                window.location.href = "{% url 'login' %}";
                {% endif %}
            });
        });
    });
</script>
{% endblock %}